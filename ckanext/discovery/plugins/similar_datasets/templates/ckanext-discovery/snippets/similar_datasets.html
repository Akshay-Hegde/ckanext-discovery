{#

List of similar datasets.


Parameters:

    id: ID of the package for which similar datasets should be listed. This
        must be the actual ID, passing the name is not supported.

    max_num: Maximum number of datasets to list. Defaults to 5.

    min_score: Minimum required score. Datasets with a lower similarity score
        are not listed. Defaults to 0.


Example:

    {% snippet 'ckanext-discovery/snippets/similar_datasets',
               id=c.pkg_dict.id,
               max_num=3,
               min_score=0.3 %}

#}

{% set max_num = max_num or 5 %}
{% set min_score = min_score or 0 %}
{% set pkg_dicts = h.discovery_similar_datasets(id, max_num=max_num, min_score=min_score) %}

{% block similar_datasets %}
    <section class="module module-narrow module-shallow similar-datasets">
    {% block similar_datasets_title %}
        <h2 class="module-heading"><i class="icon-medium icon-exchange"></i>{{ _('Similar datasets') }}</h2>
    {% endblock %}
    {% block similar_datasets_list %}
        <ul class="nav nav-simple">
            {% for pkg_dict in pkg_dicts %}
                {% set url = h.url_for(controller='package', action='read', id=pkg_dict.name) %}
                {% set notes = h.truncate(pkg_dict.notes, 200) %}
                <li class="nav-item">
                    {% block similar_dataset scoped %}
                         <a href="{{ url }}" title="{{ notes }}">
                            {{ pkg_dict.title }}
                        </a>
                    {% endblock %}
                </li>
            {% endfor %}
        </ul>
    {% endblock %}
    </section>
{% endblock %}

